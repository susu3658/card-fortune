<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸€ç”Ÿè‡³å°‘è¦çœ‹ä¸€æ¬¡çš„å‘¨æ˜“</title>
    <style>
        body { text-align: center; font-family: Arial, sans-serif; }
        .card-container { 
            display: flex; 
            flex-wrap: wrap; 
            justify-content: center; 
            width: 90vw; 
            height: auto;
            margin: auto; 
            position: relative; 
        }
        .card { 
            width: 50px; 
            height: 75px; 
            border: 1px solid black; 
            margin: 5px; 
            text-align: center; 
            line-height: 75px; 
            background-color: gray; 
            cursor: pointer; 
            color: transparent; 
            transition: transform 0.5s ease-in-out, background-color 0.3s;
            position: relative;
            font-size: 16px;
        }
        .card.back {
            background-color: black;
            color: transparent;
        }
        .selected { background-color: yellow; color: black; }
        .selected-card-container {
            margin-top: 20px;
        }
        .red { color: red; }
        .black { color: black; }
        .hidden { display: none; }
        
        /* ë°˜ì‘í˜• ìŠ¤íƒ€ì¼ */
        @media (max-width: 600px) {
            .card-container {
                width: 95vw;
                height: auto;
                display: flex;
                flex-wrap: wrap;
            }
            .card {
                width: 12vw;
                height: 18vw;
                font-size: 2.5vw;
                line-height: 18vw;
            }
            button {
                font-size: 4vw;
                padding: 10px;
            }
            h1 {
                font-size: 5vw;
            }
        }
    </style>
</head>
<body>
    <h1>ä¸€ç”Ÿè‡³å°‘è¦çœ‹ä¸€æ¬¡çš„å‘¨æ˜“</h1>
    <button id="startButton" onclick="startGame()">ç‚¹å‡»å¼€å§‹</button>
    <p style="font-size: 16px; margin-top: 20px;">
        youtube: <a href="https://youtube.com/@kimkaphan3714" target="_blank">youtube.com/@kimkaphan3714</a><br>
        å¾®ä¿¡ ID: <a href="mailto:hanguopengyou001">hanguopengyou001</a>
    </p>
    <button id="shuffleButton" onclick="shuffleDeck()" class="hidden">æ´—ç‰Œ (<span id="shuffleCount">3</span>å‰©ä½™æ¬¡æ•°)</button>
    <div class="card-container" id="deck"></div>
    <p id="message"></p>
    <div class="selected-card-container" id="selectedCardContainer"></div>
    
    <script>
        let deck = [];
        let selectedCard = null;
        let shuffleRemaining = 3;
        let cardElements = [];
        let cardSelected = false;
        
        function startGame() {
            document.getElementById("startButton").classList.add("hidden");
            document.getElementById("shuffleButton").classList.remove("hidden");
            document.getElementById("deck").classList.remove("hidden");
            document.getElementById("message").innerText = "";
    document.querySelector("h1").innerText = "è¯·æ´—ç‰Œä¸‰æ¬¡ï¼Œç„¶åé€‰ä¸€å¼ ç‰Œ";
    document.querySelector("p").innerHTML = "â€» ä¸ºä»€ä¹ˆè¦æ´—ç‰Œä¸‰æ¬¡ï¼Ÿæ•°å­—3è±¡å¾ç€å¤©åœ°äººä¸‰æ‰ä¹‹å˜åŒ–çš„å®Œæˆï¼Œåœ¨å½¢æˆå¦è±¡çš„è¿‡ç¨‹ä¸­å…·æœ‰é‡è¦æ„ä¹‰";

            generateDeck();
            renderDeck();
        }
        
function generateDeck() {
    const suits = [
        { symbol: 'â™ ', color: 'black' },
        { symbol: 'â™¥', color: 'red' },
        { symbol: 'â™¦', color: 'red' },
        { symbol: 'â™£', color: 'black' }
    ];
    const values = ['2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'A'];  // âœ… K ì œê±°!
    deck = [];

    for (let suit of suits) {
        for (let value of values) {
            deck.push({ text: value + suit.symbol, color: suit.color });
        }
    }
    deck.push({ text: 'Joker1', color: 'black' });  // âœ… ì¡°ì»¤ ì¶”ê°€
    deck.push({ text: 'Joker2', color: 'red' });

    // âŒ `shuffleDeck();` ì‚­ì œ! ì‚¬ìš©ìê°€ ë²„íŠ¼ì„ ëˆŒëŸ¬ì•¼ë§Œ ì„ì„.
}

        function renderDeck() {
            let deckDiv = document.getElementById("deck");
            deckDiv.innerHTML = "";
            cardElements = [];
            deck.forEach((card, index) => {
                let cardDiv = document.createElement("div");
                cardDiv.classList.add("card", "back");
                cardDiv.innerText = "?";
                cardDiv.style.position = "relative";
                cardDiv.onclick = () => selectCard(cardDiv, index);
                deckDiv.appendChild(cardDiv);
                cardElements.push(cardDiv);
            });
        }
        
function shuffleDeck() {
    if (shuffleRemaining > 0) {
        let shuffleButton = document.getElementById("shuffleButton");
        shuffleButton.disabled = true;  // ì„ê¸° ë²„íŠ¼ ë¹„í™œì„±í™”

        let deckContainer = document.getElementById("deck");
        let centerX = deckContainer.offsetWidth / 2 - 25;
        let centerY = Math.min(deckContainer.getBoundingClientRect().top + 30, window.innerHeight * 0.3);

        cardElements.forEach((card) => {
            card.style.transform = `translate(${centerX - card.offsetLeft}px, ${centerY - card.offsetTop}px) scale(0.2)`;
        });

        setTimeout(() => {
            for (let i = 0; i < 3; i++) {
                deck = deck.sort(() => Math.random() - 0.5);
            }
            console.log("å¡ç‰Œå·²æ´—ç‰Œä¸‰æ¬¡:", deck);

            shuffleRemaining--;
            document.getElementById("shuffleCount").innerText = shuffleRemaining;

            setTimeout(() => {
                cardElements.forEach((card) => {
                    card.innerText = "?";
                    card.style.color = "transparent";
                    card.style.transform = "translate(0, 0) scale(1)";
                });

                if (shuffleRemaining === 0) {
                    document.getElementById("shuffleButton").innerText = "è¯·é€‰æ‹©ä¸€å¼ ç‰Œ";
                }

                shuffleButton.disabled = false;
            }, 500);
        }, 1500);
    }
}

function selectCard(cardDiv, index) {
    if (shuffleRemaining > 0) {
        document.getElementById("message").innerText = "è¯·å®Œæˆä¸‰æ¬¡æ´—ç‰Œåå†é€‰ä¸€å¼ ç‰Œ.";
        return;
    }
    if (cardSelected) return;

    cardSelected = true;
    selectedCard = deck[index];

    cardDiv.classList.remove("back");
    cardDiv.innerText = selectedCard.text;
    cardDiv.style.color = selectedCard.color;

    // âœ… ì„ íƒí•œ ì¹´ë“œë¥¼ ë±ì—ì„œ ì œê±° (ğŸ”¥ ê¸°ì¡´ ì½”ë“œì— ì¶”ê°€í•´ì•¼ í•¨)
    deck.splice(index, 1);  

    // âœ… ì„ íƒí•œ ì¹´ë“œì™€ ë± ì €ì¥ (ë± ìˆœì„œ ìœ ì§€!)
    localStorage.setItem("selectedCard", selectedCard.text);
    localStorage.setItem("deck", JSON.stringify(deck));  // ğŸ”¥ ì„ íƒí•œ ì¹´ë“œ ì œê±°ëœ ë± ì €ì¥

    setTimeout(() => {
        window.location.href = "card_fortune2.html";
    }, 1000);
}

</script>

