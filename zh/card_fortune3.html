<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìµœì¢… ì¹´ë“œ ì„ íƒ</title>
    <style>
        body {
            text-align: center;
            font-family: Arial, sans-serif;
        }

        .deck-container {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 30px;
            margin-top: 20px;
        }

        .side-deck-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
        }

        .side-deck {
            width: 100px;
            height: 150px;
            background-color: gray;
            border: 2px solid black;
            text-align: center;
            line-height: 150px;
            font-size: 16px;
            color: white;
            cursor: pointer;
            position: relative;
        }

        .deck-count {
            font-size: 14px;
            font-weight: bold;
            margin-top: 5px;
        }

        .message {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .discard-container {
            position: absolute;
            width: 150px;
            height: 200px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

.discard-card {
    width: 100px;  /* ê¸°ì¡´ side-deckê³¼ ë™ì¼í•œ í¬ê¸° */
    height: 150px; /* ê¸°ì¡´ side-deckê³¼ ë™ì¼í•œ í¬ê¸° */
    background-color: gray;
    border: 2px solid black;
    text-align: center;
    line-height: 150px;
    font-size: 16px;
    color: white;
    position: absolute;
    animation: flyAway 0.5s forwards;
}

@keyframes flyAway {
    0% { transform: translate(0, 0) rotate(0deg); opacity: 1; }
    100% { transform: translateX(-150px) rotate(-20deg); opacity: 0; } /* ì™¼ìª½ìœ¼ë¡œ ë‚ ì•„ê° */
}

@keyframes flyAwayRight {
    0% { transform: translate(0, 0) rotate(0deg); opacity: 1; }
    100% { transform: translateX(150px) rotate(20deg); opacity: 0; } /* ì˜¤ë¥¸ìª½ìœ¼ë¡œ ë‚ ì•„ê° */
}

        .selected-cards {
            position: absolute;
            bottom: 10px;
            right: 10px;
            width: 120px;
            height: auto;
            display: flex;
            flex-direction: column-reverse;
            align-items: center;
        }

        .selected-card {
            font-size: 16px;
            font-weight: bold;
            color: black;
            margin-bottom: 5px;
        }

        .selected-first-card {
            position: absolute;
            bottom: 10px;
            left: 10px;
            font-size: 16px;
            font-weight: bold;
            color: black;
        }

    </style>
</head>
<body>
    <h1>è¯·ç”¨å·¦æ‰‹ç‚¹å‡»å·¦æ‰‹å¡ç‰Œï¼Œç”¨å³æ‰‹ç‚¹å‡»å³æ‰‹å¡ç‰Œ</h1>
    <p class="message" id="message">è¯·ç”¨å·¦æ‰‹å¼ƒæ‰4å¼ ç‰Œï¼Œç„¶åæŠ½å–1å¼ æ–°ç‰Œ. <span id="discardCounter">(4/4)</span></p>

    <div class="deck-container">
        <div class="side-deck-container">
            <div class="side-deck" id="leftDeck" onclick="discardCard('left')">å·¦æ‰‹å¡ç‰Œ</div>
            <p class="deck-count" id="leftCount"></p>
        </div>

        <div class="side-deck-container">
            <div class="side-deck" id="rightDeck" onclick="discardCard('right')">å³æ‰‹å¡ç‰Œ</div>
            <p class="deck-count" id="rightCount"></p>
        </div>
    </div>

    <div class="discard-container" id="discardArea"></div>
    <div class="selected-cards" id="selectedCards"></div>
    <div class="selected-first-card" id="firstCardDisplay"></div>

<button id="copyButton" onclick="copyResult()" style="width: 200px; height: 50px; font-size: 18px; background-color: gray; color: white; display: none; position: absolute; left: 50%; transform: translateX(-50%); top: 80%;">å¤åˆ¶ç»“æœ</button>
<p id="copyMessage" style="font-size: 18px; font-weight: bold; margin-top: 10px;"></p>

    
</body>
</html>








<script>

function disableClick() {
    document.getElementById("leftDeck").style.pointerEvents = "none";
    document.getElementById("rightDeck").style.pointerEvents = "none";
}

function enableClick() {
    document.getElementById("leftDeck").style.pointerEvents = "auto";
    document.getElementById("rightDeck").style.pointerEvents = "auto";
}

        let leftCards = parseInt(localStorage.getItem("leftCards")) || 0;
        let rightCards = parseInt(localStorage.getItem("rightCards")) || 0;
        let leftDeck = [];
let rightDeck = [];
let selectedFirstCard = localStorage.getItem("selectedCard");
        let finalCards = [];
        let step = 0;
        let isLeftTurn = true;
        let discardCount = 4;
        let discardSequence = [4, 8, 4, 4, 8, 4];
        let suits = ["â—†", "â™ ", "â™¥", "â™£"];

        document.getElementById("leftCount").innerText = `å¡ç‰Œ: ${leftCards}å¼ `;
        document.getElementById("rightCount").innerText = `å¡ç‰Œ: ${rightCards}å¼ `;

        if (selectedFirstCard) {
            document.getElementById("firstCardDisplay").innerText = `æ‰€é€‰å¡ç‰Œ: ${selectedFirstCard}`;
        }
let isClickable = true; // í´ë¦­ ê°€ëŠ¥ ì—¬ë¶€

// ë””ë²„ê¹…ìš© card_fortune3.html ì½”ë“œ ìˆ˜ì • ë° ì‹¤í–‰ í…ŒìŠ¤íŠ¸

// ë””ë²„ê¹…ìš© card_fortune3.html ì½”ë“œ ìˆ˜ì • ë° ì‹¤í–‰ í…ŒìŠ¤íŠ¸

function discardCard(hand) {
    if (step >= 6) return; // 6ë²ˆì§¸ ì„ íƒ ì´í›„ í´ë¦­ ê¸ˆì§€

    let expectedHand = step < 3 ? "left" : "right"; // 0~2ë‹¨ê³„: ì™¼ì†, 3~5ë‹¨ê³„: ì˜¤ë¥¸ì†
    if (hand !== expectedHand) {
        console.error(`âŒ [ERROR] ${hand} ì†ì—ì„œëŠ” ë²„ë¦´ ìˆ˜ ì—†ìŒ!`);
        return;
    }

    // âœ… currentDeckì„ ë°°ì—´ë¡œ ë³€í™˜
    let currentDeckKey = hand === "left" ? "leftDeck" : "rightDeck";
    let currentDeck = JSON.parse(localStorage.getItem(currentDeckKey)) || []; // âœ… JSON.parse()ë¡œ ë³€í™˜

    if (!Array.isArray(currentDeck) || currentDeck.length === 0) {
        console.error(`âŒ [ERROR] ${hand} ë±ì´ ë¹„ì–´ ìˆìŒ!`);
        return;
    }

    let discardedCard = currentDeck.shift(); // âœ… ì²« ë²ˆì§¸ ì¹´ë“œ ì œê±°
    localStorage.setItem(currentDeckKey, JSON.stringify(currentDeck)); // âœ… ë³€ê²½ëœ ë±ì„ ë‹¤ì‹œ ì €ì¥

    document.getElementById(hand === "left" ? "leftCount" : "rightCount").innerText = `å¡ç‰Œ: ${currentDeck.length}ì¥`;

    let deckElement = document.getElementById(hand === "left" ? "leftDeck" : "rightDeck");

    let discardCard = document.createElement("div");
    discardCard.classList.add("discard-card");
    discardCard.innerText = discardedCard.text;

    let deckRect = deckElement.getBoundingClientRect();
    discardCard.style.position = "absolute";
    discardCard.style.left = `${deckRect.left}px`;
    discardCard.style.top = `${deckRect.top}px`;

    discardCard.style.animation = hand === "left" ? "flyAway 0.5s forwards" : "flyAwayRight 0.5s forwards";
    document.body.appendChild(discardCard);

    setTimeout(() => {
        discardCard.remove();
    }, 500);

    discardCount--;

    if (discardCount <= 0) {
        discardCount = 0;
        disableClick();
        setTimeout(() => {
            console.log("[DEBUG] ì¹´ë“œ ë½‘ê¸° ì‹œì‘!");
            drawCard(hand);
        }, 500);
    }

    updateMessage();
}

// âœ… 3ë‹¨ê³„ì—ì„œ ì˜¬ë°”ë¥¸ ë± ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
function initializeDecks() {
    leftDeck = JSON.parse(localStorage.getItem("leftDeck")) || [];
    rightDeck = JSON.parse(localStorage.getItem("rightDeck")) || [];

    // ğŸ’¡ ì² í•™ ë°˜ì˜: ì–‘ì† ëª¨ë‘ ë’¤ì—ì„œë¶€í„° ì—´ê¸° ìœ„í•´ reverse
    leftDeck.reverse();  // í˜„ì¬ ìƒí™©, ê¸°ì¤€ì  ë”°ë¼ ë³€í™”
    rightDeck.reverse(); // íƒ€ê³ ë‚œ ì„±ì§ˆ, ê³ ì •ëœ íë¦„

    localStorage.setItem("leftDeck", JSON.stringify(leftDeck));
    localStorage.setItem("rightDeck", JSON.stringify(rightDeck));

    document.getElementById("leftCount").innerText = `å¡ç‰Œ: ${leftDeck.length}å¼ `;
    document.getElementById("rightCount").innerText = `å¡ç‰Œ: ${rightDeck.length}å¼ `;

    const selectedCard = localStorage.getItem("selectedCard");
    if (selectedCard) {
        document.getElementById("firstCardDisplay").innerText = `æ‰€é€‰å¡ç‰Œ: ${selectedCard}`;
    }

    console.log("âœ… [DEBUG] ë± ì´ˆê¸°í™” ì™„ë£Œ (ì–‘ì† reverse ì ìš©)");
}


// âœ… í˜ì´ì§€ ë¡œë”© ì‹œ ë± ë°ì´í„° ì´ˆê¸°í™”
initializeDecks();

function drawCard(hand) {
    if (step >= 6) return; // 6ë²ˆì§¸ ì„ íƒ ì´í›„ í´ë¦­ ê¸ˆì§€

    let currentDeckKey = hand === "left" ? "leftDeck" : "rightDeck";
    let currentDeck = JSON.parse(localStorage.getItem(currentDeckKey)) || [];

    if (!currentDeck || currentDeck.length === 0) {
        console.error(`âŒ [ERROR] ${hand} ë±ì´ ë¹„ì–´ ìˆìŒ!`);
        return;
    }

    let chosenCard = currentDeck.shift(); // ì˜¬ë°”ë¥¸ ìˆœì„œëŒ€ë¡œ ì¹´ë“œ ë½‘ê¸°
    localStorage.setItem(currentDeckKey, JSON.stringify(currentDeck));

    document.getElementById(hand === "left" ? "leftCount" : "rightCount").innerText = `å¡ç‰Œ: ${currentDeck.length}ì¥`;

    let deckElement = document.getElementById(hand === "left" ? "leftDeck" : "rightDeck"); 
    let originalText = deckElement.innerText;
    deckElement.innerText = chosenCard.text;

    console.log(`[DEBUG] ${hand}ä¸­æŠ½å–å¡ç‰Œ: ${chosenCard.text}, å‰©ä½™å¡ç‰Œæ•°: ${currentDeck.length}`);

    disableClick();

    setTimeout(() => {
        deckElement.innerText = originalText;
        let selectedCardsArea = document.getElementById("selectedCards");
        let newCard = document.createElement("div");
        newCard.classList.add("selected-card");
        newCard.innerText = chosenCard.text;
        selectedCardsArea.prepend(newCard);

        step++;
        discardCount = discardSequence[step] || 0;

        console.log(`[DEBUG] ç°åœ¨ step: ${step}, ä¸‹ä¸€æ­¥ discardCount: ${discardCount}`);

        if (step >= 6) {
            localStorage.setItem("finalCards", JSON.stringify(finalCards));
            document.getElementById("message").innerText = `ç‚¹å‡»å¤åˆ¶æŒ‰é’®å³å¯å¤åˆ¶ç»“æœ`;
            disableClick(); // ìµœì¢… ê²°ê³¼ê°€ ë‚˜ì˜¤ë©´ ë” ì´ìƒ í´ë¦­ë˜ì§€ ì•Šë„ë¡ í•¨
            showCopyButton(); // ë³µì‚¬ ë²„íŠ¼ì„ í‘œì‹œ
        } else {
            updateMessage();
            enableClick();
        }

    }, 2000);
}

// ë³µì‚¬ ë²„íŠ¼ì„ ë³´ì´ê²Œ í•˜ëŠ” í•¨ìˆ˜
function showCopyButton() {
    document.getElementById("copyButton").style.display = "block"; // ë²„íŠ¼ ë³´ì´ê²Œ ì„¤ì •
}

function updateMessage() {
    let totalDiscard = discardSequence[step] || 4; // í˜„ì¬ ë‹¨ê³„ì—ì„œ ë²„ë ¤ì•¼ í•  ì´ ì¹´ë“œ ìˆ˜ ì„¤ì •
    document.getElementById("message").innerHTML =
        `${step < 3 ? "ç”¨å·¦æ‰‹" : "ç”¨å³æ‰‹"}å¼ƒæ‰ ${discardCount}å¼ ç‰Œ,ç„¶åæŠ½å–1å¼ ç‰Œ. <span id="discardCounter">(${discardCount}/${totalDiscard})</span>`;
}

        setTimeout(updateMessage, 1000);

function copyResult() {
    let firstCard = document.getElementById("firstCardDisplay").innerText.trim(); // ì²˜ìŒ ì¹´ë“œ
    let selectedCards = Array.from(document.querySelectorAll("#selectedCards .selected-card"))
                               .map(card => card.innerText.trim()); // ë‚˜ë¨¸ì§€ ì¹´ë“œë“¤

    let result = `<${firstCard}> ${selectedCards.reverse().join('/')}`; // ì¹´ë“œ í˜•ì‹: <â™£1> â™£8/â—†6/â™ 3/â™¥9/â™£5/â™¥3

    // í´ë¦½ë³´ë“œë¡œ ë³µì‚¬
    navigator.clipboard.writeText(result).then(() => {
        // ë³µì‚¬ ì™„ë£Œ í›„ ë²„íŠ¼ í…ìŠ¤íŠ¸ ë° ìƒ‰ìƒ ë³€ê²½
        document.getElementById("copyButton").innerText = "âˆšå¤åˆ¶å®Œæˆ";
        document.getElementById("copyButton").style.backgroundColor = "darkgreen"; // ì§™ì€ ë…¹ìƒ‰
        document.getElementById("copyMessage").innerText = ""; // ë³µì‚¬ ì™„ë£Œ ë©”ì‹œì§€ ì œê±°
    }).catch(err => {
        console.error("å¤åˆ¶å¤±è´¥:", err);
    });
}
function showCopyButton() {
    document.getElementById("copyButton").style.display = "block"; // ë²„íŠ¼ ë³´ì´ê²Œ ì„¤ì •
}

    
</script>
